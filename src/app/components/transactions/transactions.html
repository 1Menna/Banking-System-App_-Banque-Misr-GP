<div class="title">
  <h5>Transaction History</h5>
  <p>View and filter your account transactions</p>
</div>
<div class="container">
  <div class="card-design">
    <div class="d-flex">
    <a class="navbar-brand text-dark">
      <i class=" filter-icon fa-solid fa-filter"></i>
    </a>
    <p class="icon-desc">Filters<p>
    </div>
    <div class="transaction-info d-flex col-lg-6 col-md-12 col-12 justify-content-between">
   <div class="search">
    <p class="info-p">Search Description</p>
     <i class=" search-icon fa-solid fa-sm fa-magnifying-glass"></i>
    <input type="text" [(ngModel)]="query" class="search-field" 
    placeholder=" Search by description..."/> 
    <small class="text-muted">
      Showing {{(transactions | transactionFilter:query:typeFilter).length}} of {{transactions.length}} transactions
    </small>
   </div>
   <div class="transaction-type">
    <p class="info-p">Transaction Type</p>
     <select class="form-select w-auto" id="transactionTypes" [(ngModel)]="typeFilter">
      <option value="">All Types</option>
      <option value="Credit">Credit</option>
      <option value="Debit">Debit</option>
    </select>
   </div>
  </div>
  </div>
</div>

@if ((transactions | transactionFilter:query:typeFilter).length === 0) {
  <div class="text-muted">
    No transactions found.
  </div>
} @else {
  <div class="stack">
    @for (t of (visibleTransactions | transactionFilter:query:typeFilter); track t.id) {
     <!-- <app-transactions [transactions]="t"></app-transactions> -->
    }
  </div>
}

<div class="container">
  <div class="card-design">
     <div class="transactions mt-4">
  <h6>Transactions</h6>
  <p class="transactions-no">{{ (transactions | transactionFilter:query:typeFilter).length }} transactions found</p>

  @if ((transactions | transactionFilter:query:typeFilter).length === 0) {
    <p class="text-muted">No transactions found</p>
  } @else {
    <div class="stack">
      @for (t of (visibleTransactions | transactionFilter:query:typeFilter); track t.id) {
        <div class="transaction-item card p-3 mb-2" (click)="showDetails(t)">
          <div class="d-flex justify-content-between align-items-center">
            <div class="d-flex align-items-center gap-3">
              <div class="icon">
  <i class="fa-solid" 
     [ngClass]="{
       'fa-arrow-trend-up': t.type === 'Credit', 
       'fa-arrow-trend-down': t.type !== 'Credit',
     }">
  </i>
</div>
              <div class="icon-info">
                <p class="description fw-bold mb-1">{{ t.description }}</p>
                <div class="date-type d-flex align-items-center gap-2">
                <p class="text-muted mb-0">{{ t.date | date:'MMM d,y'}}</p>
                <span [ngClass]="t.type ==='Credit' ? 'badge bg-primary': 'badge bg-success' ">{{ t.type }}</span>
              </div>
              </div>
              
            </div>
            <div class="text-end">
              <p [ngClass]="t.type === 'Credit' ? 'text-success' : 'text-danger'" class="fw-bold mb-1">
                {{t.type === 'Credit' ? '+' : '--'}}
                {{ t.amount| currency:'USD':'symbol' }}
              </p>
              <p class="text-muted mb-0">Transaction ID: {{ t.id }}</p>
            </div>
          </div>
        </div>
      }
      <button class="load-more" (click)="loadMore()" *ngIf="visibleCount < transactions.length">Load More</button>

    </div>
  }
</div>

@if (selectedTransaction) {
  <div class="transaction-details card mt-4 p-3">
    <h6>Transaction Details</h6>
    <p><strong>ID:</strong> {{ selectedTransaction.id }}</p>
    <p><strong>Description:</strong> {{ selectedTransaction.description }}</p>
    <p><strong>Type:</strong> {{ selectedTransaction.type }}</p>
    <p><strong>Amount:</strong>
      <span [ngClass]="selectedTransaction.type === 'Credit' ? 'text-success' : 'text-danger'">
        {{ selectedTransaction.amount | currency:'USD':'symbol' }}
      </span>
    </p>
    <p><strong>Date:</strong> {{ selectedTransaction.date }}</p>

    <button class="btn btn-sm btn-secondary mt-2" (click)="closeDetails()">Close</button>
  </div>
}
  </div>
</div> 
